<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poultry A2Z - Admin Panel</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <!-- React CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f7fa;
            color: #333;
        }

        .admin-header {
            background: linear-gradient(135deg, #2c5530, #4a7c59);
            color: white;
            padding: 20px 0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .admin-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .admin-title {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .admin-title h1 {
            font-size: 28px;
        }

        .admin-main {
            padding: 30px 0;
        }

        .admin-nav {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .nav-btn {
            padding: 12px 24px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        .nav-btn:hover {
            border-color: #4a7c59;
            background: #f8f9fa;
        }

        .nav-btn.active {
            background: #4a7c59;
            border-color: #4a7c59;
            color: white;
        }

        .admin-content {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .section-title {
            font-size: 24px;
            color: #2c5530;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-input,
        .form-textarea,
        .form-select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-input:focus,
        .form-textarea:focus,
        .form-select:focus {
            outline: none;
            border-color: #4a7c59;
        }

        .form-textarea {
            height: 100px;
            resize: vertical;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #4a7c59;
            color: white;
        }

        .btn-primary:hover {
            background: #2c5530;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #545b62;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }

        .categories-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .category-item {
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s;
        }

        .category-item:hover {
            border-color: #4a7c59;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .category-title {
            font-size: 16px;
            font-weight: 600;
            color: #2c5530;
            margin-bottom: 5px;
        }

        .category-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
        }

        .badge-products {
            background: #e3f2fd;
            color: #1976d2;
        }

        .badge-services {
            background: #f3e5f5;
            color: #7b1fa2;
        }

        .badge-supplies {
            background: #e8f5e8;
            color: #388e3c;
        }

        .category-actions {
            display: flex;
            gap: 8px;
            margin-top: 15px;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
        }

        .json-editor {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            height: 400px;
            overflow-y: auto;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #4a7c59, #2c5530);
            color: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-number {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: #28a745;
        }

        .notification.error {
            background: #dc3545;
        }

        .notification.info {
            background: #17a2b8;
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 30px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e0e0e0;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        .products-list {
            margin-top: 15px;
        }

        .product-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .product-info h4 {
            margin-bottom: 5px;
            color: #2c5530;
        }

        .product-info p {
            font-size: 12px;
            color: #666;
        }

        .product-price {
            font-weight: bold;
            color: #4a7c59;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }

            .nav-buttons {
                flex-direction: column;
            }

            .categories-list {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }
        }
    </style>
</head>

<body>
    <div id="admin-root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Main Admin App
        function AdminApp() {
            const [data, setData] = useState(null);
            const [activeTab, setActiveTab] = useState('dashboard');
            const [loading, setLoading] = useState(true);
            const [editingCategory, setEditingCategory] = useState(null);

            // Load data
            useEffect(() => {
                loadData();
            }, []);

            const loadData = async () => {
                try {
                    const response = await fetch('/api/data');
                    const jsonData = await response.json();
                    setData(jsonData);
                    setLoading(false);
                } catch (error) {
                    console.error('Error loading data:', error);
                    showNotification('Error loading data', 'error');
                    setLoading(false);
                }
            };

            const saveData = async (newData) => {
                try {
                    const response = await fetch('/api/data', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(newData)
                    });

                    const result = await response.json();
                    
                    if (response.ok) {
                        setData(newData);
                        showNotification(`Data saved successfully! Backup: ${result.backup}`, 'success');
                    } else {
                        throw new Error(result.error || 'Failed to save data');
                    }
                } catch (error) {
                    console.error('Error saving data:', error);
                    showNotification('Error saving data: ' + error.message, 'error');
                }
            };

            const showNotification = (message, type = 'info') => {
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                notification.textContent = message;
                document.body.appendChild(notification);

                setTimeout(() => notification.classList.add('show'), 100);
                setTimeout(() => {
                    notification.classList.remove('show');
                    setTimeout(() => document.body.removeChild(notification), 300);
                }, 3000);
            };

            if (loading) {
                return <div style={{ padding: '50px', textAlign: 'center' }}>Loading Admin Panel...</div>;
            }

            return (
                <>
                    <AdminHeader />
                    <main className="admin-main">
                        <div className="admin-container">
                            <AdminNavigation activeTab={activeTab} setActiveTab={setActiveTab} />
                            <div className="admin-content">
                                {activeTab === 'dashboard' && <Dashboard data={data} />}
                                {activeTab === 'categories' && (
                                    <CategoriesManager
                                        data={data}
                                        saveData={saveData}
                                        setEditingCategory={setEditingCategory}
                                    />
                                )}
                                {activeTab === 'settings' && <Settings data={data} saveData={saveData} />}
                                {activeTab === 'json' && <JsonEditor data={data} saveData={saveData} />}
                            </div>
                        </div>
                    </main>

                    {editingCategory && (
                        <CategoryModal
                            category={editingCategory}
                            data={data}
                            saveData={saveData}
                            onClose={() => setEditingCategory(null)}
                        />
                    )}
                </>
            );
        }

        // Admin Header
        function AdminHeader() {
            return (
                <header className="admin-header">
                    <div className="admin-container">
                        <div className="admin-title">
                            <i className="fas fa-cogs"></i>
                            <h1>Poultry A2Z Admin Panel</h1>
                        </div>
                    </div>
                </header>
            );
        }

        // Navigation
        function AdminNavigation({ activeTab, setActiveTab }) {
            const tabs = [
                { id: 'dashboard', label: 'Dashboard', icon: 'fa-chart-bar' },
                { id: 'categories', label: 'Categories', icon: 'fa-th-large' },
                { id: 'settings', label: 'Settings', icon: 'fa-cog' },
                { id: 'json', label: 'JSON Editor', icon: 'fa-code' }
            ];

            return (
                <nav className="admin-nav">
                    <div className="nav-buttons">
                        {tabs.map(tab => (
                            <button
                                key={tab.id}
                                className={`nav-btn ${activeTab === tab.id ? 'active' : ''}`}
                                onClick={() => setActiveTab(tab.id)}
                            >
                                <i className={`fas ${tab.icon}`}></i>
                                {tab.label}
                            </button>
                        ))}
                    </div>
                </nav>
            );
        }

        // Dashboard
        function Dashboard({ data }) {
            const stats = {
                totalCategories: Object.keys(data.categories).length,
                totalProducts: Object.values(data.categories).reduce((sum, cat) => sum + cat.products.length, 0),
                featuredCategories: Object.values(data.categories).filter(cat => cat.featured).length,
                inStockProducts: Object.values(data.categories).reduce((sum, cat) =>
                    sum + cat.products.filter(p => p.inStock).length, 0
                )
            };

            return (
                <div>
                    <h2 className="section-title">
                        <i className="fas fa-chart-bar"></i>
                        Dashboard Overview
                    </h2>

                    <div className="stats-grid">
                        <div className="stat-card">
                            <div className="stat-number">{stats.totalCategories}</div>
                            <div className="stat-label">Total Categories</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-number">{stats.totalProducts}</div>
                            <div className="stat-label">Total Products</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-number">{stats.featuredCategories}</div>
                            <div className="stat-label">Featured Categories</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-number">{stats.inStockProducts}</div>
                            <div className="stat-label">In Stock Products</div>
                        </div>
                    </div>

                    <h3 style={{ marginBottom: '20px' }}>Recent Categories</h3>
                    <div className="categories-list">
                        {Object.values(data.categories).slice(0, 6).map(category => (
                            <div key={category.id} className="category-item">
                                <div className="category-header">
                                    <div>
                                        <div className="category-title">{category.title}</div>
                                        <p style={{ fontSize: '12px', color: '#666' }}>{category.products.length} products</p>
                                    </div>
                                    <span className={`category-badge badge-${category.category}`}>
                                        {category.category}
                                    </span>
                                </div>
                                <p style={{ fontSize: '14px', color: '#666', marginBottom: '10px' }}>
                                    {category.description}
                                </p>
                                {category.featured && (
                                    <span style={{ fontSize: '12px', color: '#ff6b35', fontWeight: 'bold' }}>
                                        ⭐ Featured
                                    </span>
                                )}
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        // Categories Manager
        function CategoriesManager({ data, saveData, setEditingCategory }) {
            const addNewCategory = () => {
                const newCategory = {
                    id: `new-category-${Date.now()}`,
                    title: 'New Category',
                    description: 'Category description',
                    fullDescription: 'Full category description',
                    category: 'products',
                    featured: false,
                    image: 'https://images.unsplash.com/photo-1548550023-2bdb3c5beed7?w=300&h=200&fit=crop',
                    products: [],
                    features: ['Feature 1', 'Feature 2'],
                    contact: {
                        phone: '+91-9876543210',
                        email: 'contact@poultrya2z.com',
                        whatsapp: '+919876543210'
                    }
                };
                setEditingCategory(newCategory);
            };

            const deleteCategory = (categoryId) => {
                if (confirm('Are you sure you want to delete this category?')) {
                    const newData = { ...data };
                    delete newData.categories[categoryId];
                    saveData(newData);
                }
            };

            return (
                <div>
                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>
                        <h2 className="section-title">
                            <i className="fas fa-th-large"></i>
                            Manage Categories
                        </h2>
                        <button className="btn btn-primary" onClick={addNewCategory}>
                            <i className="fas fa-plus"></i>
                            Add New Category
                        </button>
                    </div>

                    <div className="categories-list">
                        {Object.values(data.categories).map(category => (
                            <div key={category.id} className="category-item">
                                <div className="category-header">
                                    <div>
                                        <div className="category-title">{category.title}</div>
                                        <p style={{ fontSize: '12px', color: '#666' }}>
                                            {category.products.length} products • {category.category}
                                        </p>
                                    </div>
                                    <span className={`category-badge badge-${category.category}`}>
                                        {category.category}
                                    </span>
                                </div>

                                <p style={{ fontSize: '14px', color: '#666', marginBottom: '15px' }}>
                                    {category.description}
                                </p>

                                <div className="products-list">
                                    {category.products.slice(0, 2).map(product => (
                                        <div key={product.id} className="product-item">
                                            <div className="product-info">
                                                <h4>{product.name}</h4>
                                                <p>{product.description}</p>
                                            </div>
                                            <div className="product-price">{product.price}</div>
                                        </div>
                                    ))}
                                    {category.products.length > 2 && (
                                        <p style={{ fontSize: '12px', color: '#666', textAlign: 'center', marginTop: '10px' }}>
                                            +{category.products.length - 2} more products
                                        </p>
                                    )}
                                </div>

                                <div className="category-actions">
                                    <button
                                        className="btn btn-primary btn-small"
                                        onClick={() => setEditingCategory(category)}
                                    >
                                        <i className="fas fa-edit"></i>
                                        Edit
                                    </button>
                                    <button
                                        className="btn btn-danger btn-small"
                                        onClick={() => deleteCategory(category.id)}
                                    >
                                        <i className="fas fa-trash"></i>
                                        Delete
                                    </button>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        // Settings
        function Settings({ data, saveData }) {
            const [settings, setSettings] = useState(data.siteConfig);

            const handleSave = () => {
                const newData = {
                    ...data,
                    siteConfig: settings
                };
                saveData(newData);
            };

            return (
                <div>
                    <h2 className="section-title">
                        <i className="fas fa-cog"></i>
                        Site Settings
                    </h2>

                    <div className="form-group">
                        <label className="form-label">Site Title</label>
                        <input
                            type="text"
                            className="form-input"
                            value={settings.title}
                            onChange={(e) => setSettings({ ...settings, title: e.target.value })}
                        />
                    </div>

                    <div className="form-group">
                        <label className="form-label">Tagline</label>
                        <input
                            type="text"
                            className="form-input"
                            value={settings.tagline}
                            onChange={(e) => setSettings({ ...settings, tagline: e.target.value })}
                        />
                    </div>

                    <div className="form-row">
                        <div className="form-group">
                            <label className="form-label">Base Price</label>
                            <input
                                type="number"
                                className="form-input"
                                value={settings.todayRate.basePrice}
                                onChange={(e) => setSettings({
                                    ...settings,
                                    todayRate: { ...settings.todayRate, basePrice: parseInt(e.target.value) }
                                })}
                            />
                        </div>
                        <div className="form-group">
                            <label className="form-label">Price Fluctuation Range</label>
                            <input
                                type="number"
                                className="form-input"
                                value={settings.todayRate.fluctuationRange}
                                onChange={(e) => setSettings({
                                    ...settings,
                                    todayRate: { ...settings.todayRate, fluctuationRange: parseInt(e.target.value) }
                                })}
                            />
                        </div>
                    </div>

                    <button className="btn btn-success" onClick={handleSave}>
                        <i className="fas fa-save"></i>
                        Save Settings
                    </button>
                </div>
            );
        }

        // JSON Editor
        function JsonEditor({ data, saveData }) {
            const [jsonText, setJsonText] = useState(JSON.stringify(data, null, 2));
            const [error, setError] = useState('');

            const handleSave = () => {
                try {
                    const parsedData = JSON.parse(jsonText);
                    saveData(parsedData);
                    setError('');
                } catch (err) {
                    setError('Invalid JSON format: ' + err.message);
                }
            };

            return (
                <div>
                    <h2 className="section-title">
                        <i className="fas fa-code"></i>
                        JSON Editor
                    </h2>

                    <p style={{ marginBottom: '20px', color: '#666' }}>
                        Edit the raw JSON data. Be careful with the format!
                    </p>

                    {error && (
                        <div style={{ background: '#ffebee', color: '#c62828', padding: '15px', borderRadius: '8px', marginBottom: '20px' }}>
                            <strong>Error:</strong> {error}
                        </div>
                    )}

                    <textarea
                        className="json-editor"
                        value={jsonText}
                        onChange={(e) => setJsonText(e.target.value)}
                        style={{ width: '100%', height: '500px' }}
                    />

                    <div style={{ marginTop: '20px', display: 'flex', gap: '15px' }}>
                        <button className="btn btn-success" onClick={handleSave}>
                            <i className="fas fa-save"></i>
                            Save JSON
                        </button>
                        <button
                            className="btn btn-secondary"
                            onClick={() => setJsonText(JSON.stringify(data, null, 2))}
                        >
                            <i className="fas fa-undo"></i>
                            Reset
                        </button>
                    </div>
                </div>
            );
        }

        // Category Modal
        function CategoryModal({ category, data, saveData, onClose }) {
            const [editedCategory, setEditedCategory] = useState({ ...category });
            const [showAddProduct, setShowAddProduct] = useState(false);
            const [newProduct, setNewProduct] = useState({
                id: '',
                name: '',
                price: '',
                image: '',
                description: '',
                inStock: true
            });

            const handleSave = () => {
                const newData = { ...data };
                newData.categories[editedCategory.id] = editedCategory;
                saveData(newData);
                onClose();
            };

            const addProduct = () => {
                if (!newProduct.name || !newProduct.price) {
                    alert('Please fill in product name and price');
                    return;
                }

                const productWithId = {
                    ...newProduct,
                    id: newProduct.id || `product-${Date.now()}`
                };

                setEditedCategory({
                    ...editedCategory,
                    products: [...editedCategory.products, productWithId]
                });

                // Reset form
                setNewProduct({
                    id: '',
                    name: '',
                    price: '',
                    image: '',
                    description: '',
                    inStock: true
                });
                setShowAddProduct(false);
            };

            const removeProduct = (productId) => {
                setEditedCategory({
                    ...editedCategory,
                    products: editedCategory.products.filter(p => p.id !== productId)
                });
            };

            const handleImageUpload = (e, isProduct = false, productId = null) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        const imageDataUrl = event.target.result;

                        if (isProduct && productId) {
                            // Update existing product image
                            setEditedCategory({
                                ...editedCategory,
                                products: editedCategory.products.map(p =>
                                    p.id === productId ? { ...p, image: imageDataUrl } : p
                                )
                            });
                        } else if (isProduct) {
                            // Update new product image
                            setNewProduct({ ...newProduct, image: imageDataUrl });
                        } else {
                            // Update category image
                            setEditedCategory({ ...editedCategory, image: imageDataUrl });
                        }
                    };
                    reader.readAsDataURL(file);
                }
            };

            const updateProductField = (productId, field, value) => {
                setEditedCategory({
                    ...editedCategory,
                    products: editedCategory.products.map(p =>
                        p.id === productId ? { ...p, [field]: value } : p
                    )
                });
            };

            return (
                <div className="modal">
                    <div className="modal-content">
                        <div className="modal-header">
                            <h3>Edit Category: {editedCategory.title}</h3>
                            <button className="modal-close" onClick={onClose}>&times;</button>
                        </div>

                        <div className="form-group">
                            <label className="form-label">Title</label>
                            <input
                                type="text"
                                className="form-input"
                                value={editedCategory.title}
                                onChange={(e) => setEditedCategory({ ...editedCategory, title: e.target.value })}
                            />
                        </div>

                        <div className="form-group">
                            <label className="form-label">Description</label>
                            <textarea
                                className="form-textarea"
                                value={editedCategory.description}
                                onChange={(e) => setEditedCategory({ ...editedCategory, description: e.target.value })}
                            />
                        </div>

                        <div className="form-row">
                            <div className="form-group">
                                <label className="form-label">Category Type</label>
                                <select
                                    className="form-select"
                                    value={editedCategory.category}
                                    onChange={(e) => setEditedCategory({ ...editedCategory, category: e.target.value })}
                                >
                                    <option value="products">Products</option>
                                    <option value="services">Services</option>
                                    <option value="supplies">Supplies</option>
                                </select>
                            </div>
                            <div className="form-group">
                                <label className="form-label">
                                    <input
                                        type="checkbox"
                                        checked={editedCategory.featured}
                                        onChange={(e) => setEditedCategory({ ...editedCategory, featured: e.target.checked })}
                                        style={{ marginRight: '8px' }}
                                    />
                                    Featured Category
                                </label>
                            </div>
                        </div>

                        <div className="form-group">
                            <label className="form-label">Category Image</label>
                            <div style={{ display: 'flex', gap: '15px', alignItems: 'flex-start' }}>
                                <div style={{ flex: 1 }}>
                                    <input
                                        type="url"
                                        className="form-input"
                                        value={editedCategory.image}
                                        onChange={(e) => setEditedCategory({ ...editedCategory, image: e.target.value })}
                                        placeholder="https://example.com/image.jpg or upload file"
                                        style={{ marginBottom: '10px' }}
                                    />
                                    <input
                                        type="file"
                                        accept="image/*"
                                        onChange={(e) => handleImageUpload(e, false)}
                                        className="form-input"
                                        style={{ padding: '8px' }}
                                    />
                                </div>
                                {editedCategory.image && (
                                    <img
                                        src={editedCategory.image}
                                        alt="Category preview"
                                        style={{ width: '80px', height: '60px', objectFit: 'cover', borderRadius: '4px', border: '2px solid #e0e0e0' }}
                                    />
                                )}
                            </div>
                        </div>

                        <div className="form-group">
                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '15px' }}>
                                <label className="form-label">Products ({editedCategory.products.length})</label>
                                <button className="btn btn-primary btn-small" onClick={() => setShowAddProduct(true)}>
                                    <i className="fas fa-plus"></i>
                                    Add Product
                                </button>
                            </div>

                            <div className="products-list">
                                {editedCategory.products.map((product) => (
                                    <div key={product.id} className="product-item">
                                        <div style={{ display: 'flex', gap: '15px', alignItems: 'center', flex: 1 }}>
                                            {product.image && (
                                                <img
                                                    src={product.image}
                                                    alt={product.name}
                                                    style={{ width: '50px', height: '40px', objectFit: 'cover', borderRadius: '4px' }}
                                                />
                                            )}
                                            <div className="product-info" style={{ flex: 1 }}>
                                                <input
                                                    type="text"
                                                    value={product.name}
                                                    onChange={(e) => updateProductField(product.id, 'name', e.target.value)}
                                                    style={{ border: 'none', background: 'transparent', fontWeight: 'bold', marginBottom: '5px', width: '100%' }}
                                                />
                                                <input
                                                    type="text"
                                                    value={product.price}
                                                    onChange={(e) => updateProductField(product.id, 'price', e.target.value)}
                                                    style={{ border: 'none', background: 'transparent', fontSize: '12px', width: '100%', marginBottom: '5px' }}
                                                />
                                                <input
                                                    type="file"
                                                    accept="image/*"
                                                    onChange={(e) => handleImageUpload(e, true, product.id)}
                                                    style={{ fontSize: '11px', padding: '2px' }}
                                                />
                                            </div>
                                        </div>
                                        <button
                                            className="btn btn-danger btn-small"
                                            onClick={() => removeProduct(product.id)}
                                        >
                                            <i className="fas fa-trash"></i>
                                        </button>
                                    </div>
                                ))}
                            </div>

                            {showAddProduct && (
                                <div style={{ background: '#f8f9fa', padding: '20px', borderRadius: '8px', marginTop: '15px' }}>
                                    <h5 style={{ marginBottom: '15px' }}>Add New Product</h5>

                                    <div className="form-row">
                                        <div className="form-group">
                                            <label className="form-label">Product Name</label>
                                            <input
                                                type="text"
                                                className="form-input"
                                                value={newProduct.name}
                                                onChange={(e) => setNewProduct({ ...newProduct, name: e.target.value })}
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">Price</label>
                                            <input
                                                type="text"
                                                className="form-input"
                                                value={newProduct.price}
                                                onChange={(e) => setNewProduct({ ...newProduct, price: e.target.value })}
                                                placeholder="₹100/kg"
                                            />
                                        </div>
                                    </div>

                                    <div className="form-group">
                                        <label className="form-label">Product Image</label>
                                        <div style={{ display: 'flex', gap: '15px', alignItems: 'flex-start' }}>
                                            <div style={{ flex: 1 }}>
                                                <input
                                                    type="url"
                                                    className="form-input"
                                                    value={newProduct.image}
                                                    onChange={(e) => setNewProduct({ ...newProduct, image: e.target.value })}
                                                    placeholder="https://example.com/product-image.jpg or upload file"
                                                    style={{ marginBottom: '10px' }}
                                                />
                                                <input
                                                    type="file"
                                                    accept="image/*"
                                                    onChange={(e) => handleImageUpload(e, true)}
                                                    className="form-input"
                                                    style={{ padding: '8px' }}
                                                />
                                            </div>
                                            {newProduct.image && (
                                                <img
                                                    src={newProduct.image}
                                                    alt="Product preview"
                                                    style={{ width: '80px', height: '60px', objectFit: 'cover', borderRadius: '4px', border: '2px solid #e0e0e0' }}
                                                />
                                            )}
                                        </div>
                                    </div>

                                    <div className="form-group">
                                        <label className="form-label">Description</label>
                                        <textarea
                                            className="form-textarea"
                                            value={newProduct.description}
                                            onChange={(e) => setNewProduct({ ...newProduct, description: e.target.value })}
                                            style={{ height: '80px' }}
                                        />
                                    </div>

                                    <div className="form-group">
                                        <label className="form-label">
                                            <input
                                                type="checkbox"
                                                checked={newProduct.inStock}
                                                onChange={(e) => setNewProduct({ ...newProduct, inStock: e.target.checked })}
                                                style={{ marginRight: '8px' }}
                                            />
                                            In Stock
                                        </label>
                                    </div>

                                    <div style={{ display: 'flex', gap: '10px' }}>
                                        <button className="btn btn-success" onClick={addProduct}>
                                            <i className="fas fa-plus"></i>
                                            Add Product
                                        </button>
                                        <button className="btn btn-secondary" onClick={() => setShowAddProduct(false)}>
                                            Cancel
                                        </button>
                                    </div>
                                </div>
                            )}
                        </div>

                        <div style={{ display: 'flex', gap: '15px', marginTop: '30px' }}>
                            <button className="btn btn-success" onClick={handleSave}>
                                <i className="fas fa-save"></i>
                                Save Changes
                            </button>
                            <button className="btn btn-secondary" onClick={onClose}>
                                <i className="fas fa-times"></i>
                                Cancel
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        // Render the admin app
        ReactDOM.render(<AdminApp />, document.getElementById('admin-root'));
    </script>
</body>

</html>